

-- Data Validation and Cleaning
-- Check Null Values

SELECT
    SUM(CASE WHEN State IS NULL THEN 1 ELSE 0 END) AS null_state,
    SUM(CASE WHEN City IS NULL THEN 1 ELSE 0 END) AS null_city,
    SUM(CASE WHEN Order_Date IS NULL THEN 1 ELSE 0 END) AS null_order_date,
    SUM(CASE WHEN Restaurant_Name IS NULL THEN 1 ELSE 0 END) AS null_restaurant_name,
    SUM(CASE WHEN Location IS NULL THEN 1 ELSE 0 END) AS null_location,
    SUM(CASE WHEN Category IS NULL THEN 1 ELSE 0 END) AS null_category,
    SUM(CASE WHEN Dish_Name IS NULL THEN 1 ELSE 0 END) AS null_dish_name,
    SUM(CASE WHEN Price_INR IS NULL THEN 1 ELSE 0 END) AS null_price_inr,
    SUM(CASE WHEN Rating IS NULL THEN 1 ELSE 0 END) AS null_rating,
    SUM(CASE WHEN Rating_Count IS NULL THEN 1 ELSE 0 END) AS null_rating_count
FROM swiggy_data;

-- Blank or Empty Strings
Select *
From swiggy_data
where
State ='' Or City='' OR Restaurant_Name = '' OR Location ='' OR Category = '' OR Dish_Name =''

-- Duplicate Detection
Select 
State,City,Order_Date,Restaurant_Name,Location,Category,Dish_Name,Price_INR,
Rating, Rating_Count, count(*) as CNT
from 
swiggy_data
group by State,City,Order_Date,Restaurant_Name,Location,Category,Dish_Name,Price_INR,
Rating, Rating_Count
having count(*)>1 

--Delete Duplication
With CTE AS (
Select *, ROW_NUMBER() Over(
Partition by State,City,Order_Date,Restaurant_Name,Location,Category,Dish_Name,Price_INR,
Rating, Rating_Count
Order by (Select Null)
) as rn
from swiggy_data
)
Delete from CTE where rn>1

